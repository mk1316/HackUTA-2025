{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 199, "column": 0}, "map": {"version":3,"sources":["file:///Users/piyushsingh/HackUTA-2025/re-factor/src/app/api/generate-humorous-summary/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { GoogleGenAI } from '@google/genai';\n\n/**\n * API route for generating humorous summaries of syllabus PDFs\n * Creates funny, engaging summaries while maintaining course information\n * \n * @param request - Next.js request object containing the uploaded file\n * @returns JSON response with humorous summary or error message\n */\nexport async function POST(request: NextRequest): Promise<NextResponse> {\n  try {\n    // Extract file from form data\n    const formData = await request.formData();\n    const file = formData.get('file') as File;\n\n    // Validate file presence\n    if (!file) {\n      return NextResponse.json(\n        { error: 'No file provided' }, \n        { status: 400 }\n      );\n    }\n\n    // Validate file type - only PDF files are allowed\n    if (file.type !== 'application/pdf') {\n      return NextResponse.json(\n        { error: 'File must be a PDF' }, \n        { status: 400 }\n      );\n    }\n\n    // Validate file size (optional - limit to 10MB)\n    const maxSizeInBytes = 10 * 1024 * 1024; // 10MB\n    if (file.size > maxSizeInBytes) {\n      return NextResponse.json(\n        { error: 'File size must be less than 10MB' }, \n        { status: 400 }\n      );\n    }\n\n    // Convert file to base64 for Gemini API\n    const arrayBuffer = await file.arrayBuffer();\n    const base64 = Buffer.from(arrayBuffer).toString('base64');\n\n    // Validate API key presence\n    const apiKey = process.env.GEMINI_API_KEY;\n    if (!apiKey) {\n      console.error('GEMINI_API_KEY environment variable is not set');\n      return NextResponse.json(\n        { error: 'API configuration error' }, \n        { status: 500 }\n      );\n    }\n\n    // Initialize Gemini AI client\n    const genAI = new GoogleGenAI({ apiKey });\n\n    // Prepare content for humorous summary optimized for ElevenLabs audio generation\n    const humorousPrompt = `\n    Create a hilarious and entertaining AUDIO summary of this course syllabus that will be converted to speech using text-to-speech technology.\n    \n    CRITICAL INSTRUCTIONS FOR AUDIO GENERATION:\n    1. Write in a conversational, spoken tone - like you're talking to a friend\n    2. Use natural speech patterns and contractions (don't, can't, won't, etc.)\n    3. Include natural pauses with ellipses or dashes for breathing\n    4. Use expressive language that sounds good when spoken aloud\n    5. Keep it between 2-3 minutes of speaking time (roughly 300-450 words)\n    6. Start with an engaging hook like \"Hey there, future student!\"\n    7. Use direct address (\"you\", \"your\") to make it personal\n    8. Include natural speech fillers like \"so\", \"well\", \"you know\"\n    9. End with an encouraging or humorous sign-off\n    \n    CONTENT FOCUS:\n    - Course name and what you're actually getting into\n    - The workload in relatable terms (\"buckle up, buttercup\")\n    - Key deadlines and how to not get caught off guard\n    - Professor info and any interesting policies\n    - The most important assignments and how to tackle them\n    - Any curveballs or surprises in the syllabus\n    - Survival tips and encouragement\n    \n    TONE REQUIREMENTS:\n    - Conversational and friendly, like a wise upperclassman\n    - Humorous but not mean-spirited\n    - Encouraging and supportive\n    - Use college slang and references students will relate to\n    - Make it sound natural when spoken, not like written text\n    \n    FORMAT FOR SPEECH:\n    - Use short, punchy sentences\n    - Include natural emphasis with ALL CAPS for important points\n    - Use ellipses for natural pauses... like this\n    - Include rhetorical questions to engage the listener\n    - End with a memorable closing line\n    \n    Make it sound like a podcast episode about your class!\n    `;\n\n    const contents = [\n      { \n        text: humorousPrompt\n      },\n      {\n        inlineData: {\n          mimeType: 'application/pdf',\n          data: base64\n        }\n      }\n    ];\n\n    // Generate humorous summary using Gemini\n    const result = await genAI.models.generateContent({\n      model: \"gemini-2.0-flash-exp\",\n      contents: contents\n    });\n    const rawResponse = result.text;\n\n    // Validate response exists\n    if (!rawResponse) {\n      throw new Error('No response received from AI');\n    }\n\n    // Return successful response with humorous summary\n    return NextResponse.json({ \n      result: rawResponse,\n      success: true \n    });\n\n  } catch (error) {\n    // Log error for debugging\n    console.error('Error generating humorous summary:', error);\n    \n    // Return user-friendly error message\n    return NextResponse.json(\n      { \n        error: 'Failed to generate humorous summary. Please try again.',\n        success: false \n      },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AASO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,8BAA8B;QAC9B,MAAM,WAAW,MAAM,QAAQ,QAAQ;QACvC,MAAM,OAAO,SAAS,GAAG,CAAC;QAE1B,yBAAyB;QACzB,IAAI,CAAC,MAAM;YACT,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAmB,GAC5B;gBAAE,QAAQ;YAAI;QAElB;QAEA,kDAAkD;QAClD,IAAI,KAAK,IAAI,KAAK,mBAAmB;YACnC,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAqB,GAC9B;gBAAE,QAAQ;YAAI;QAElB;QAEA,gDAAgD;QAChD,MAAM,iBAAiB,KAAK,OAAO,MAAM,OAAO;QAChD,IAAI,KAAK,IAAI,GAAG,gBAAgB;YAC9B,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAmC,GAC5C;gBAAE,QAAQ;YAAI;QAElB;QAEA,wCAAwC;QACxC,MAAM,cAAc,MAAM,KAAK,WAAW;QAC1C,MAAM,SAAS,OAAO,IAAI,CAAC,aAAa,QAAQ,CAAC;QAEjD,4BAA4B;QAC5B,MAAM,SAAS,QAAQ,GAAG,CAAC,cAAc;QACzC,IAAI,CAAC,QAAQ;YACX,QAAQ,KAAK,CAAC;YACd,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA0B,GACnC;gBAAE,QAAQ;YAAI;QAElB;QAEA,8BAA8B;QAC9B,MAAM,QAAQ,IAAI,4KAAW,CAAC;YAAE;QAAO;QAEvC,iFAAiF;QACjF,MAAM,iBAAiB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAsCxB,CAAC;QAED,MAAM,WAAW;YACf;gBACE,MAAM;YACR;YACA;gBACE,YAAY;oBACV,UAAU;oBACV,MAAM;gBACR;YACF;SACD;QAED,yCAAyC;QACzC,MAAM,SAAS,MAAM,MAAM,MAAM,CAAC,eAAe,CAAC;YAChD,OAAO;YACP,UAAU;QACZ;QACA,MAAM,cAAc,OAAO,IAAI;QAE/B,2BAA2B;QAC3B,IAAI,CAAC,aAAa;YAChB,MAAM,IAAI,MAAM;QAClB;QAEA,mDAAmD;QACnD,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,QAAQ;YACR,SAAS;QACX;IAEF,EAAE,OAAO,OAAO;QACd,0BAA0B;QAC1B,QAAQ,KAAK,CAAC,sCAAsC;QAEpD,qCAAqC;QACrC,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,OAAO;YACP,SAAS;QACX,GACA;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}